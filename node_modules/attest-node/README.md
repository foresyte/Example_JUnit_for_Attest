#Attest API

This API allows the use of the Attest accessibility checking and reporting API from a Node.js application. It works with npm through a custom registry built on the Artifactory application ().

## Installation:

Set up your [custom registry](artifactory-setup.md). Note: if you cannot use an external registry, then please contact Deque systems for information on how to download the `.tgz` file for use with npm.

### Custom Rules

If you are using (or plan on using) custom rules, follow these instructions. Otherwise use a ruleSetID when initializing the API (see below)

Download custom rules from the Deque registry and note location on your file system. In the command below, replace "customer-id" with the ID for your organization, given to you by Deque Systems.

#### Local Installation

```
npm install attest-rules --registry https://agora.dequecloud.com/artifactory/api/npm/customer-id/

```

#### Global Installation

```
npm install -g attest-rules --registry https://agora.dequecloud.com/artifactory/api/npm/company-id/
```
#### Environment Variable

Add an environment variable in `.bash_profile` (or equivalent Windows profile settings) pointing to the location of the custom rules file on your local hard drive*:

```
export ATTEST_PATH=~/path_to_customer_your/attest.json
```

#### Local Attest file

If the `ATTEST_PATH` env variable is not set, Attest will check for an `attest.json` file
in the project root. If that file is not found, the default 'wcag2' ruleset will be used.

```
export ATTEST_PATH=~/path_to_customer_your/attest.json
```

*Note: Restart the terminal for path changes to take effect.

### No custom rules yet

If you do not have custom rules yet and wish to start with an empty custom rule set. Create an `attest.json` file in the local directory with an empty JavaScript object in it (`{}`).

### Install Attest API and its dependencies:

```
npm install attest-node --registry https://agora.dequecloud.com/artifactory/api/npm/attest-virtual/
```
# API

The attest-node module is a Node.js module and can be required in your source code as follows:

```
var attestModule = require('attest-node');
```

## Description

attestModule is a function that can be used to initialize Attest.

## Synopsis

`attestModule(ruleSetID);`

## Parameters

* `ruleSetID` - **optional** String identifying the rule set. Current valid values are `'wcag2'` for WCAG 2 level A and AA, `'508'` for Section 508, and `'devMin'` for a minimal rule set for developers who are just beginning with accessibility.

Use the ruleSetID parameter, only if you do not want to use custom rules. If you want to use custom rules, use the custom rule configuration described above.

**Returns:** AttestNode object

### AttestNode object

The object returned by the initialization function has the following properties

```
{
		source: String of the entire Attest source code that can be used for injecting into remote browsers,
		report: Function to initialize the reporting system,
		standards: Array of standard configuration definitions,
}
```

### AttestNode:source

This is a string that is the entire source code of the Attest library plus the configuration that has been chosen by the ruleSetID OR the custom rules configuration. This is useful for sending to a remote browser through a system like Selenium's `ExecuteScript` or `ExecuteAsyncScript` calls.

### AttestNode:report

See the [report API documentation](docs/report.md) for a description of how to use this API.

### AttestNode:standards

This is an Array of objects with the following structure

```
{
	id: String ID of the configuration
	defn: Object with the configuration
}
```

Currently valid IDs are `'wcag2'`, `'508'` and `'devMin`'

## Example

There is an example of how to use the Attest Node API and the reporting API in conjunction with the open source version of axe-webdriverjs in the [docs/examples directory](docs/examples/readme.md)


# Contributing

Information on how to install and build attest-node as a contributor is available in [contributor.md](contributor.md).
